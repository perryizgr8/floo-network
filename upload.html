{{define "upload"}}
<h1>Welcome to the Floo Network!</h1>
<i>Select your file.</i><br /><br /><br />
<input type="file" id="fileInput"><br /><br />
<button onclick="uploadFile()">Toss a handful of Floo Powder into the fireplace!</button>
<script>
    function uploadFile() {
        var fileInput = document.getElementById("fileInput");
        var file = fileInput.files[0];
        filename = file.name;
        var xhr = new XMLHttpRequest();
        xhr.open("PUT", "{{.Url}}");
        xhr.setRequestHeader("Content-Type", "application/octet-stream");
        xhr.send(file);

        // send file name to server and display the response
        var xhr = new XMLHttpRequest();
        xhr.open("POST", "/renameandgetdownloadurl")
        xhr.setRequestHeader("Content-Type", "application/json");
        var data = {
            "filename": filename,
            "tempfilename": "{{.TempFilename}}"
        }
        xhr.send(JSON.stringify(data));
        xhr.onreadystatechange = function () {
            if (xhr.readyState == XMLHttpRequest.DONE) {
                alert(xhr.responseText);
            }
        }
    }
</script>
{{end}}